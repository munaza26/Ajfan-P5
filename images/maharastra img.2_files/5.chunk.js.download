(this["webpackJsonpwishlist-drawer"]=this["webpackJsonpwishlist-drawer"]||[]).push([[5],{18:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));const i={removeFromWishlistOnCart:["craftymeraki.com","oh-my-crafty-supplies-inc.myshopify.com"],showPricesOnLogin:["craftbeer-company.myshopify.com"]}},79:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return _}));var i=a(0),s=a.n(i),r=a(32),o=a.n(r),n=a(13),l=a.n(n),d=a(18),h=a(1);const c=s.a.lazy((()=>a.e(6).then(a.bind(null,34)))),m=s.a.lazy((()=>Promise.all([a.e(2),a.e(7)]).then(a.bind(null,77)))),u="iwish.myshopapps.com/API/V1/",g=d.a.removeFromWishlistOnCart;class _ extends s.a.Component{constructor(){super(),this._isMounted=!1,this.getShopId=async t=>{if("undefined"!==typeof Storage){var e=localStorage.getItem("iWishShop");if(e&&e==t){let t=localStorage.getItem("iWishId");this.setState({shop_id:t})}else{var a="https://api.myshopapps.com/wishlist/V1/getShopId/?shopUrl="+t;const e=await o()(a),i=await e.json();let s=null===i||void 0===i?void 0:i.res;localStorage.setItem("iWishShop",t),localStorage.setItem("iWishId",s),this.setState({shop_id:s})}}},this.backdropClick=()=>{this.setState({drawerOpen:!this.state.drawerOpen});try{document.documentElement.dispatchEvent(new CustomEvent("cart:refresh",{})),document.dispatchEvent(new CustomEvent("cart:build",(function(t){}))),document.dispatchEvent(new CustomEvent("cart:update",{bubbles:!0,detail:{}})),document.documentElement.dispatchEvent(new CustomEvent("cart:refresh",{bubbles:!0,detail:{}})),document.dispatchEvent(new CustomEvent("theme:cart:change",{detail:{},bubbles:!0})),document.dispatchEvent(new CustomEvent("theme:cartchanged",{bubbles:!0,cancelable:!1}))}catch(t){}},this.myRef=s.a.createRef(),this.scrollUp=this.scrollUp.bind(this),this.deleteWishlistItem=this.deleteWishlistItem.bind(this),this.drawerToggle=this.drawerToggle.bind(this),this.deleteLocalItem=this.deleteLocalItem.bind(this),this.getWishlistData=this.getWishlistData.bind(this),this.getLocalData=this.getLocalData.bind(this),this.addToCart=this.addToCart.bind(this),this.setActivePage=this.setActivePage.bind(this),this.addAllToCart=this.addAllToCart.bind(this),this.state={current_variant:"",cur_language:"en",flag:0,drawerOpen:!1,isClicked:!1,wishlist:[],customer_id:null,cartClass:"",shop_domain:"",products:{},loading:!1,no_items:!1,cartBtnText:"Add To Cart",currentPage:1,totalCount:null,isData:!1,isDeleted:!0,cart_error:""}}componentDidMount(){this._isMounted=!0;var t=l()("#drawer_data").attr("data-classes"),e=l()("#drawer_data").attr("data-customer_id"),a=l()("#drawer_data").attr("data-domain"),i=l()("#drawer_data").attr("data-cart-class"),s=l()("#drawer_data").attr("data-cur_language");this.setState({current_variant:"",enable_pro_quantity:0,shop_domain:a,cartClass:i,customer_id:e,cur_language:s});var r=this;this.getShopId(a),l()(t).click((function(){var t=JSON.stringify(window.iWishlistmain)||localStorage.getItem("iWishlistmain");""!==e?(r.setState({customer_id:e}),setTimeout(function(){r.drawerData()}.bind(this),300)):setTimeout(function(){r.without_login(t,1)}.bind(this),300)}))}scrollUp(){this.myRef.current.firstChild.scrollTo(0,0)}setActivePage(t){this.setState({currentPage:t})}isInWishlist(t,e){var a=JSON.parse(localStorage.getItem("iWishlistmain"));return"undefined"!==typeof a[t]&&null!=e&&a[t].indexOf(e)>=0}checkIwishDrawer(t,e){var a,i=l()("#drawer_data").attr("data-template_name");(a=l()("body").find("[data-variant="+e+"]"))||(a=l()("body").find("[data-product="+t+"]")),this.isInWishlist(t,e)?a.length>0&&("true"===i?a.addClass("iwishAdded").html(window.iwish_added_txt_col):a.addClass("iwishAdded").html(window.iwish_added_txt)):a.length>0&&("true"===i?a.removeClass("iwishAdded").html(window.iwish_add_txt_col):a.removeClass("iwishAdded").html(window.iwish_add_txt))}async localPagination(t,e){var a=JSON.parse(t),i=0,s=10;if(e>1){var r=10*e;i=r-10,s=r}var o=[],n=0;for(const[l,d]of Object.entries(a))d.forEach((t=>{++n>i&&n<=s&&o.push({[l]:t})}));return o}async without_login(){let t=arguments.length>1?arguments[1]:void 0;var e=localStorage.getItem("iWishCnt");await this.setState({drawerOpen:!this.state.drawerOpen}),e>0&&this.state.drawerOpen?this.getLocalData(t):this.setState({wishlist:[],no_items:!0,loading:!1,isData:!0})}async getLocalData(t){var e=localStorage.getItem("iWishlistmain"),a=JSON.parse(l()("#drawer_data").attr("data-active-currency"));this.setState({wishlist:[],loading:!0,isData:!1});var i=localStorage.getItem("iWishCnt"),s=await this.localPagination(e,t);const r={cur_language:this.state.cur_language,active_cur:a.active,products:s,shop_domain:this.state.shop_domain,customer_id:this.state.customer_id};var n="https://"+u+"ShopifyApi/localWishlistData";o()(n,{method:"POST",body:JSON.stringify(r)}).then((t=>t.json())).then((e=>{if(this._isMounted){if(e.data){let a=null===e||void 0===e?void 0:e.flag;this.setState({wishlist:e.data,flag:a,no_items:!1,loading:!1,totalCount:i,currentPage:t,isData:!0})}else this.setState({wishlist:[],no_items:!0,loading:!1,error_msg:"Wishlist is empty .... ",isData:!0});this.setActivePage(t)}})).catch((t=>{this.setState({wishlist:[],no_items:!0,loading:!1,error_msg:"Error loading wishlist ..Please try again.. ",isData:!0})}))}async without_login_noloader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.setState({isData:!1});var e=localStorage.getItem("iWishlistmain"),a=localStorage.getItem("iWishCnt"),i=JSON.parse(l()("#drawer_data").attr("data-active-currency")),s=await this.localPagination(e,t);if(a>0){const e={cur_language:this.state.cur_language,currentPage:t,active_cur:i.active,products:s,shop_domain:this.state.shop_domain,customer_id:this.state.customer_id};var r="https://"+u+"ShopifyApi/localWishlistData";const n=await o()(r,{method:"POST",body:JSON.stringify(e)}),l=await n.json();this._isMounted&&(this.setActivePage(t),this.setState({wishlist:l.data,no_items:!1,totalCount:a,isData:!0})),this.scrollUp()}else this.setState({wishlist:[],no_items:!0,isData:!0})}async drawerData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.setState({drawerOpen:!0,isData:!1});let e=0,a=localStorage.getItem("category_id");a&&(e=a);try{this._isMounted?this.getWishlistData(t,null,e):this.setState({wishlist:[]})}catch(i){this.setState({wishlist:[]})}}async getWishlistData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";var i=JSON.parse(l()("#drawer_data").attr("data-active-currency"));this.setState({isData:!1}),"delete"!==e&&this.setState({loading:!0,wishlist:[]});var s="https://"+u+"ShopifyApi/getWishlistData",r=this.state.shop_domain,n=this.state.customer_id;let d={cur_language:this.state.cur_language,active_cur:i.active,shop_domain:r,customer_id:n,currentPage:t,pageNumber:t,category_id:a};const h=await o()(s,{method:"POST",body:JSON.stringify(d)}),c=await h.json();if(this.setState({loading:!1}),c.error)this.setState({currentPage:t,wishlist:[],no_items:!0,enable_pro_quantity:0,loading:!1,error_msg:"Wishlist is empty .... ",isData:!0});else{let e=null===c||void 0===c?void 0:c.flag;this.setActivePage(t),this.setState({wishlist:c.data,flag:e,enable_pro_quantity:parseInt(c.enable_pro_quantity),no_items:!1,loading:!1,totalCount:c.totalCount,currentPage:t,isData:!0})}}deleteLocalItem(t,e,a){var i,s,r=l()("#drawer_data").attr("data-template_name");s=l()('a[data-variant="'+t+'"]');var o=JSON.parse(localStorage.getItem("iWishlistmain")),n=localStorage.getItem("iWishCnt");if((null===(i=o[e])||void 0===i?void 0:i.indexOf(t))>=0){var d=o[e].indexOf(t);o[e].splice(d,1),this.checkIwishDrawer(e,t),0===o[e].length&&delete o[e],n--,l()(".iWishCount").html(window.iWishCnt),l()(".iwish-counter").html(n),s.hasClass("iwishAdded")&&s.removeClass("iwishAdded"),"false"===r?s.html(window.iwish_add_txt):s.html(window.iwish_add_txt_col),localStorage.setItem("iWishCnt",n),localStorage.setItem("iWishlistmain",JSON.stringify(o));let i=1;if(n>10){let t=a-1;i=n/10>t?a:t}this.without_login_noloader(i)}}async deleteWishlistItem(t,e,a,i){var s=JSON.parse(localStorage.getItem("iWishlistmain")),r=localStorage.getItem("iWishCnt");this.setState({loading:!1,currentPage:a,isData:!1,isDeleted:!1,current_variant:t});var n="https://"+u+"ShopifyApi/deleteWishlistData";let d={customer_id:this.state.customer_id,product_id:e,variant_id:t,category_id:i};const h=await o()(n,{method:"POST",body:JSON.stringify(d)});if("deleted"===(await h.json()).success){if(this.setState({isDeleted:!0,isTransfer:!1,current_variant:""}),s[e].indexOf(t)>=0){var c=s[e].indexOf(t);s[e].splice(c,1),r--,0===s[e].length&&delete s[e],l()(".iWishCount").html(window.iWishCnt),l()(".iwish-counter").html(r),localStorage.setItem("iWishCnt",r),localStorage.setItem("iWishlistmain",JSON.stringify(s)),this.checkIwishDrawer(e,t)}let o=1;if(r>10){let t=a-1;o=r/10>t?a:t}this.getWishlistData(o,"delete",i)}else this.setState({isDeleted:!0,current_variant:""})}async addToCart(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=localStorage.getItem("category_id");null===a&&(a=0);let{variant_id:i,quantity:s,product_id:r}=t;if(s>0){var n=l()("#drawer_data").attr("data-drawer_add_to_cart"),d=l()("#drawer_data").attr("data-drawer_adding_to_cart"),h=l()("#drawer_data").attr("data-drawer_added_to_cart");this.setState({isTransfer:!1}),e||l()(".icart-btn-"+i).html(d);var c={id:i,quantity:s};const t=Object.keys(c).map((t=>encodeURIComponent("items[0]["+t+"]")+"="+encodeURIComponent(c[t]))).join("&");o()("/cart/add.js",{method:"POST",body:t,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then((t=>t.json())).then((t=>{var a=this;g.indexOf(this.state.shop_domain)>=0&&(""!=this.state.customer_id?this.deleteWishlistItem(i,r,this.state.pageNumber):this.deleteLocalItem(i,r,this.state.pageNumber)),o()("/cart.js").then((t=>t.json())).then((s=>{""===a.state.cartClass&&void 0===a.state.cartClass||l()(a.state.cartClass).html(s.item_count),void 0===t.status?e||l()(".icart-btn-"+i).html(h):a.setState({cart_error:t.description}),setTimeout((()=>{l()(".icart-btn-"+i).html(n),a.setState({cart_error:""})}),4e3)}))})).catch((t=>console.error("Error in add to cart:",t)))}}async addAllToCart(){var t=l()("#drawer_data").attr("data-drawer_add_all_to_cart"),e=l()("#drawer_data").attr("data-drawer_adding_to_cart"),a=l()("#drawer_data").attr("data-drawer_added_to_cart"),i=0,s=this.state.wishlist;l()("#cart-all").html(e);var r=this,o=650;l.a.each(s,(function(t,e){"SHOPIFY"===e.inv_managment?e.inventory_qty<=0&&"CONTINUE"!=e.inventory_policy||(e.inventory_qty<=0&&"CONTINUE"==e.inventory_policy||e.inventory_qty>0)&&(i+=1,setTimeout((function(){r.addToCart(e,1)}),o),o+=650):(i+=1,setTimeout((function(){r.addToCart(e,1)}),o),o+=650)})),i>0?(l()("#cart-all").html(a),setTimeout((()=>l()("#cart-all").html(t)),1500)):setTimeout((()=>l()("#cart-all").html(t)),1500)}async drawerToggle(){this.setState({drawerOpen:!this.state.drawerOpen}),this.drawerData()}componentWillUnmount(){}render(){let t;return this.state.drawerOpen&&(t=Object(h.jsx)(c,{close:this.backdropClick})),Object(h.jsx)(i.Suspense,{fallback:Object(h.jsx)("div",{children:" Please Wait... "}),children:this._isMounted?Object(h.jsxs)("div",{ref:this.myRef,children:[Object(h.jsx)("input",{type:"hidden",id:"selectedCategory"}),t,Object(h.jsx)(m,{shop_id:this.state.shop_id,flag:this.state.flag,current_variant:this.state.current_variant,cur_language:this.state.cur_language,enable_pro_quantity:this.state.enable_pro_quantity,close:this.backdropClick,addToCart:this.addToCart,addAllToCart:this.addAllToCart,error_msg:this.state.error_msg,cart_error:this.state.cart_error,loading:this.state.loading,setActivePage:this.setActivePage,deleteLocalItem:this.deleteLocalItem,no_items:this.state.no_items,customer_id:this.state.customer_id,show:this.state.drawerOpen,wishlist_data:this.state.wishlist,deleteWishlistItem:this.deleteWishlistItem,shopDomain:this.state.shop_domain,totalCount:this.state.totalCount,currentPage:this.state.currentPage,pageNumber:this.state.pageNumber,getWishlistData:this.getWishlistData,getLocalData:this.getLocalData,scrollUp:this.scrollUp,_isMounted:this._isMounted,isData:this.state.isData,isDeleted:this.state.isDeleted})]}):null})}}}}]);
//# sourceMappingURL=5.chunk.js.map